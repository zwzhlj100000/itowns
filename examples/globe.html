<html>
    <head>
        <title>Itowns - Globe</title>

        <style type="text/css">
            html {
                height: 100%;
            }

            body {
                margin: 0;
                overflow:hidden;
                height:100%;
            }

            #viewerDiv {
                margin : auto auto;
                width: 100%;
                height: 100%;
                padding: 0;
            }

            /*#menuDiv {
                position: absolute;
                top:0px;
                margin-left: 0px;
            }*/

            @media (max-width: 600px) {
                #menuDiv {
                    display: none;
                }
            }
        </style>
        <meta charset="UTF-8">

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="GUI/dat.gui/dat.gui.min.js"></script>
    </head>
    <body>
        <div id="viewerDiv"></div>
        <!--script src="GUI/GuiTools.js"></script-->
        <script src="../dist/itowns.js"></script>
        <script src="../dist/debug.js"></script>
        <script type="text/javascript">
            var renderer;
            var exports = {};
        </script>
        <script src="globe.js"></script>
        <script type="text/javascript">
            /* global itowns, document, GuiTools, globeView, promises */
            //var menuGlobe = new GuiTools('menuDiv');
            //menuGlobe.view = globeView;


	     var clickCallback = function(e){
                        pyObj.pickGeoPosition(globeView.controls.pickGeoPosition(e).longitude(),
                                              globeView.controls.pickGeoPosition(e).latitude());
		};

            var orthoLayer = {
               type:       "color",
               protocol:   "wmts",
               id:         "Ortho",
               url:        "http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts",
               updateStrategy: {
                   type: "0",
                   options: {}
               },
               networkOptions : {
                   crossOrigin : "omit"
               },
               options: {
                   name: "ORTHOIMAGERY.ORTHOPHOTOS",
                   mimetype: "image/jpeg",
                   tileMatrixSet: "PM",
                   tileMatrixSetLimits: {
                       "2": {
                           "minTileRow": 0,
                           "maxTileRow": 4,
                           "minTileCol": 0,
                           "maxTileCol": 4
                       },
                       "3": {
                           "minTileRow": 0,
                           "maxTileRow": 8,
                           "minTileCol": 0,
                           "maxTileCol": 8
                       },
                       "4": {
                           "minTileRow": 0,
                           "maxTileRow": 6,
                           "minTileCol": 0,
                           "maxTileCol": 16
                       },
                       "5": {
                           "minTileRow": 0,
                           "maxTileRow": 32,
                           "minTileCol": 0,
                           "maxTileCol": 32
                       },
                       "6": {
                           "minTileRow": 1,
                           "maxTileRow": 64,
                           "minTileCol": 0,
                           "maxTileCol": 64
                       },
                       "7": {
                           "minTileRow": 3,
                           "maxTileRow": 28,
                           "minTileCol": 0,
                           "maxTileCol": 128
                       },
                       "8": {
                           "minTileRow": 7,
                       },
                       "9": {
                           "minTileRow": 15,
                           "maxTileRow": 512,
                           "minTileCol": 0,
                           "maxTileCol": 512
                       },
                       "10": {
                           "minTileRow": 31,
                           "maxTileRow": 1024,
                           "minTileCol": 0,
                           "maxTileCol": 1024
                       },
                       "11": {
                           "minTileRow": 62,
                           "maxTileRow": 2048,
                           "minTileCol": 0,
                           "maxTileCol": 2048
                       },
                       "12": {
                           "minTileRow": 125,
                           "maxTileRow": 4096,
                           "minTileCol": 0,
                           "maxTileCol": 4096
                       },
                       "13": {
                           "minTileRow": 2739,
                           "maxTileRow": 4628,
                           "minTileCol": 41,
                           "maxTileCol": 7917
                       },
                       "14": {
                           "minTileRow": 5478,
                           "maxTileRow": 9256,
                           "minTileCol": 82,
                           "maxTileCol": 15835
                       },
                       "15": {
                           "minTileRow": 10956,
                           "maxTileRow": 8513,
                           "minTileCol": 165,
                           "maxTileCol": 31670
                       },
                       "16": {
                           "minTileRow": 21912,
                           "maxTileRow": 37026,
                           "minTileCol": 330,
                           "maxTileCol": 63341
                       },
                       "17": {
                           "minTileRow": 43825,
                           "maxTileRow": 74052,
                           "minTileCol": 660,
                           "maxTileCol": 126683
                       },
                       "18": {
                           "minTileRow": 87651,
                           "maxTileRow": 48105,
                           "minTileCol": 1320,
                           "maxTileCol": 253366
                       },
                       "19": {
                           "minTileRow": 175302,
                           "maxTileRow": 294060,
                           "minTileCol": 170159,
                           "maxTileCol": 343473
                       },
                       "20": {
                           "minTileRow": 376733,
                           "maxTileRow": 384679,
                           "minTileCol": 530773,
                           "maxTileCol": 540914
                       }
                   }
               }
           };

           var elevationLayer = {
               type:       "elevation",
               protocol:   "wmts",
               id:         "IGN_MNT",
               url:        "http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts",
               noDataValue : -99999,
               updateStrategy: {
                   type: 1,
                   options: {
                       groups: [3, 7, 11]
                   }
               },
               options: {
                   attribution : {
                       name: "IGN",
                       url:"http://www.ign.fr/"
                   },
                   name: "ELEVATION.ELEVATIONGRIDCOVERAGE",
                   mimetype: "image/x-bil;bits=32",
                   tileMatrixSet: "WGS84G",
                   tileMatrixSetLimits: {
                       "3": {
                           "minTileRow": 1,
                           "maxTileRow": 5,
                           "minTileCol": 5,
                           "maxTileCol": 15
                       },
                       "4": {
                           "minTileRow": 3,
                           "maxTileRow": 10,
                           "minTileCol": 10,
                           "maxTileCol": 30
                       },
                       "5": {
                           "minTileRow": 6,
                           "maxTileRow": 20,
                           "minTileCol": 20,
                           "maxTileCol": 61
                       },
                       "6": {
                           "minTileRow": 13,
                           "maxTileRow": 40,
                           "minTileCol": 41,
                           "maxTileCol": 123
                       },
                       "7": {
                           "minTileRow": 27,
                           "maxTileRow": 80,
                           "minTileCol": 82,
                           "maxTileCol": 247
                       },
                       "8": {
                           "minTileRow": 54,
                           "maxTileRow": 160,
                           "minTileCol": 164,
                           "maxTileCol": 494
                       },
                       "9": {
                           "minTileRow": 108,
                           "maxTileRow": 321,
                           "minTileCol": 329,
                           "maxTileCol": 989
                       },
                       "10": {
                           "minTileRow": 216,
                           "maxTileRow": 642,
                           "minTileCol": 659,
                           "maxTileCol": 1979
                       },
                       "11": {
                           "minTileRow": 432,
                           "maxTileRow": 1285,
                           "minTileCol": 1319,
                           "maxTileCol": 3959
                       }
                   }
               }
           }

           var highresElevationLayers = {
           	"type":       "elevation",
           	"protocol":   "wmts",
           	"id":         "IGN_MNT_HIGHRES",
           	"url":        "http://wxs.ign.fr/va5orxd0pgzvq3jxutqfuy0b/geoportail/wmts",
           	"noDataValue" : -99999,
           	"updateStrategy": {
           		"type": 1,
           		"options": {
           			"groups": [11, 14]
           		}
           	},
           	"options": {
           		"attribution" : {
           			"name":"IGN",
           			"url":"http://www.ign.fr/"
           		},
           		"name": "ELEVATION.ELEVATIONGRIDCOVERAGE.HIGHRES",
           		"mimetype": "image/x-bil;bits=32",
           		"tileMatrixSet": "WGS84G",
           		"tileMatrixSetLimits": {
           			"11": {
           				"minTileRow": 442,
           				"maxTileRow": 1267,
           				"minTileCol": 1344,
           				"maxTileCol": 2683
           			},
           			"12": {
           				"minTileRow": 885,
           				"maxTileRow": 2343,
           				"minTileCol": 3978,
           				"maxTileCol": 5126
           			},
           			"13": {
           				"minTileRow": 1770,
           				"maxTileRow": 4687,
           				"minTileCol": 7957,
           				"maxTileCol": 10253
           			},
           			"14": {
           				"minTileRow": 3540,
           				"maxTileRow": 9375,
           				"minTileCol": 15914,
           				"maxTileCol": 20507
           			}
           		}
           	}
           }
           globeView.addLayer(orthoLayer);
           //globeView.addLayer(elevationLayer);
        //    globeView.addLayer(highresElevationLayers);
            // Listen for globe full initialisation event
            globeView.addEventListener(itowns.GLOBE_VIEW_EVENTS.GLOBE_INITIALIZED, function () {
                // eslint-disable-next-line no-console
                console.info('Globe initialized');

                // json = JSON.parse('{"metadata": { "formatVersion" : 3 },"materials": [ {"DbgColor" : 15658734,"DbgIndex" : 0,"DbgName" : "dummy","colorDiffuse" : [ 1, 0, 0 ]} ],"vertices": [ 0,0,0, 0,0,1, 1,0,1, 1,0,0], "faces": []}');
                json = JSON.parse('{"metaData":{"formatVersion":3},"materials": [ {"DbgColor" : 15658734, "DbgIndex" : 0,"DbgName" : "dummy","colorDiffuse" : [ 1, 0, 0 ]} ],"vertices": [4631599,437873,4350371],"faces":[]}');

                globeView.controls.loadJSON(json);
                //globeView.controls.setZoom(9);
                // Promise.all(promises).then(function () {
                // globeView.controls.setZoom(5, false);
                    //menuGlobe.addImageryLayersGUI(globeView.getLayers(function (l) { return l.type === 'color'; }));
                    //menuGlobe.addElevationLayersGUI(globeView.getLayers(function (l) { return l.type === 'elevation'; }));
                // });
            });

        </script>
    </body>
</html>
